daemon off;

worker_processes <%= ENV['NGINX_WORKERS'] || 4 %>;

events {
    use epoll;
    accept_mutex on;
    worker_connections 1024;
}

http {

    upstream backend {
		server unix:/tmp/nginx.socket fail_timeout=0;
		server prx1proton.herokuapp.com;
        # server 0.0.0.0:5001;
		# server 0.0.0.0:5002;
		# server 0.0.0.0:5003;
    }

	server {
		listen <%= ENV["PORT"] %>;
		#server_name _;

		location / {
			proxy_pass http://backend;
            #proxy_redirect off;
			#proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			#proxy_set_header Host $http_host;
		}
	}
}