daemon off;
# Heroku dynos have at least 4 cores
worker_processes <%= ENV['NGINX_WORKERS'] || 4 %>;

events {
    use epoll;
    accept_mutex on;
    worker_connections <%= ENV['NGINX_WORKER_CONNECTIONS'] || 1024 %>;
}

http {
    
	upstream backend {
		server prx1proton.herokuapp.com weight=3;
		server prx2proton.herokuapp.com;
	}

    server {
        listen <%= ENV["PORT"] %>;
        server_name _;

        location / {
			proxy_pass http://backend;
			proxy_set_header Host $proxy_host;
        }
	}
}
